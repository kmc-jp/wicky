-# coding: utf-8
%section.project
  %h2 #{project.name}
  %section.ui-editable{ 'data-preview-api' => url('/api/kramdown') }
    %div.ui-editable-view
      :kramdown
        #{project.summary}
    %form{ action: url("/api/projects/#{project.id}"), method: :post, name: 'modify-summary' }
      %p
        %input{ type: :hidden, name: :_method, value: :put }
        %input{ type: :hidden, name: :name, value: project.name }
        %textarea.ui-editable-editor{ name: :summary }
          :preserve
            #{project.summary}
      %button{ type: :submit } 編集する
  %h3 参加者
  %ul
    != list_of project.users do |user|
      = user.name
      = surround '(', ')' do
        = user.email
  %form{ action: url('/api/participations'), method: :post, name: 'participate' }
    %p
      %input{ name: :name }
      %input{ name: :email, type: :email }
      %input{ name: :project_id, type: :hidden, value: project.id }
      %input{ name: :is_leader, type: :hidden, value: false }
      %button{ type: :submit } 参加登録する
  %h3 予定
  %section
    != haml_bind :schedules, url("/projects/#{project.id}/schedules/!list"), { schedules: project.schedules }
  %hr
  %form{ action: url('/api/schedules'), method: :post, name: 'add-schedule' }
    %p
      %input{ type: :hidden, name: :project_id, value: project.id }
      %input{ name: :name }
      %input{ name: :start, type: :datetime }
      %input{ name: :end, type: :datetime }
      %input{ name: :place }
      %button{ type: :submit } 予定を作成する

:javascript
  jQuery(document).ready(function () {
    wicky.projects.main();
  });

